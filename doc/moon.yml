layer: "application"

tasks:
  clean:
    command: "uv run sphinx-build -M clean . _build"
    description: "Clean the Benji Docs build directory"

  build-html:
    command: "docker run --rm -v $PWD:/workspace -w /workspace benji-doc:latest -M html . _build"
    description: "Build the Benji Docs HTML using Docker"
    deps:
      - "benji:docker-build-doc"
    inputs:
      - "**/*.rst"
      - "**/*.md"
      - "gnc/notebooks/*.ipynb"
      - "conf.py"
    outputs:
      - "_build/html/**"

  build-pdf:
    command: "docker run --rm -v $PWD:/workspace -w /workspace benji-doc:latest -M latexpdf . _build"
    description: "Build the Benji Docs as PDF using Docker"
    deps:
      - "benji:docker-build-doc"
    inputs:
      - "**/*.rst"
      - "**/*.md"
      - "gnc/notebooks/*.ipynb"
      - "conf.py"
    outputs:
      - "_build/latex/**"

  build:
    description: "Build all Benji Docs formats"
    deps:
      - build-html
      - build-pdf

project:
  name: "Benji Docs"
  description: "Documentation for the Benji robot"
