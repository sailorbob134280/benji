

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>RT &lt;-&gt; Compute API &mdash; Benji Documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=414a3882" />

  
    <link rel="shortcut icon" href="../_static/logo.png"/>
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script type="module" src="../_static/js/custom.js?v=13a5d2d9"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="1. Record architecture decisions" href="../adr/0001-record-architecture-decisions.html" />
    <link rel="prev" title="Architecture" href="index.html" />
  <meta name="color-scheme" content="dark light">
  
  <noscript id="dark-mode-toggle-stylesheets">
    <link rel="stylesheet" href="../_static/css/light.css" type="text/css" media="(prefers-color-scheme: light)"/>
    <link rel="stylesheet" href="../_static/css/dark.css" type="text/css" media="(prefers-color-scheme: dark)"/>
  </noscript>
  <script src="../_static/js/dark-mode-toggle-stylesheets-loader.min.js"></script>
  <script type="module" src="../_static/js/dark-mode-toggle.min.mjs"></script>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div class="search-container" role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="search" name="q" placeholder="Search docs"
           aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
  <div data-nosnippet>
    
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Architecture</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#software">Software</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#deep-dives">Deep Dives</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">RT &lt;-&gt; Compute API</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#message-schema">Message Schema</a></li>
<li class="toctree-l4"><a class="reference internal" href="#interaction-model">Interaction Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#framing">Framing</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#architectural-decision-records">Architectural Decision Records</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gnc/index.html">Guidance, Navigation, and Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hardware/index.html">Hardware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../projects/index.html">Projects</a></li>
</ul>

    
  </div>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Benji</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
  <!--  -->
  
  
  
  

  <li><a href="../index.html">Docs</a> &raquo;</li>
  
     <li><a href="index.html">Architecture</a> &raquo;</li>
  
  <li>RT &lt;-&gt; Compute API</li>


  <li class="wy-breadcrumbs-aside">
    <dark-mode-toggle id="dark-mode-toggle" appearance="toggle" permanent="true"/>
  </li>
  <li class="wy-breadcrumbs-aside">
  </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="rt-compute-api">
<h1>RT &lt;-&gt; Compute API<a class="headerlink" href="#rt-compute-api" title="Link to this heading"></a></h1>
<p>The real-time processor and compute platform communicate via Protobuf messages over a UART connection.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Why not gRPC?</strong>
gRPC isn’t natively supported by Zephyr. Further, the C++ libraries required for gRPC are huge, and would be unlikely to fit on the RT processor. It’s also quite heavy for simple command/telemetry interactions.</p>
<p><strong>Why not embedded-focused RPC frameworks?</strong>
Simply put, I’m not very familiar with them. For now, a simple custom protocol built on Protobuf is sufficient.</p>
</div>
<section id="message-schema">
<h2>Message Schema<a class="headerlink" href="#message-schema" title="Link to this heading"></a></h2>
<p>The message schema is defined using Protobuf. The Protobuf definitions are located in the <a class="reference external" href="https://github.com/sailorbob134280/benji/tree/main/proto"><code class="docutils literal notranslate"><span class="pre">proto/rt_compute_api/</span></code></a> directory of the main repository.</p>
<p>Note that at this stage of the project, the message schema is still evolving. Not all features are supported yet, and breaking changes may occur.</p>
</section>
<section id="interaction-model">
<h2>Interaction Model<a class="headerlink" href="#interaction-model" title="Link to this heading"></a></h2>
<p>The interaction model is a simple controller-peripheral pattern, with the compute platform acting as the controller and the real-time processor as the peripheral. In this model, the RT core does not speak unless spoken to, even for telemetry, which must be rerquested by the compute platform.</p>
<p>There are two primary interaction types:</p>
<ul class="simple">
<li><p><strong>Command</strong> - The compute platform sends a command message to the real-time processor to perform an action, and the real-time processor responds with a status message indicating either success or an error message.</p></li>
<li><p><strong>Request/Response</strong> - The compute platform sends a request message to the real-time processor indicating which data it would like to receive, and the real-time processor responds with a either the requested data or an error message.</p></li>
</ul>
<p>The RT core can only service one interacttion at a time. Interaction completion is indicated by the response message from the RT core (status for commands, responses or error message for requests). For simplicity, streaming interactions (client, server, or bidirectional) are not currently supported.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Looking towards the future, eventually it will be worth either leveraging an existing embedded RPC framework or building a <code class="docutils literal notranslate"><span class="pre">protoc</span></code> plugin that will generate client and server stubs.</p>
</div>
</section>
<section id="framing">
<h2>Framing<a class="headerlink" href="#framing" title="Link to this heading"></a></h2>
<p>Each Protobuf message is framed with a highly simple custom protocol to allow for message boundary detection and error checking. The framing format is as follows:</p>
<ul class="simple">
<li><p><strong>Sync Marker</strong>: 4 bytes, fixed value of <code class="docutils literal notranslate"><span class="pre">0x35</span> <span class="pre">0x2e</span> <span class="pre">0xf8</span> <span class="pre">0x53</span></code> (CCSDS embedded sync marker)</p></li>
<li><p><strong>Message Length</strong>: 4 bytes, unsigned little-endian integer indicating the length of the Protobuf message in bytes, not including the sync marker, length field, or checksum.</p></li>
<li><p><strong>Data Field</strong>: Variable length Protobuf-encoded message.</p></li>
<li><p><strong>Checksum</strong>: 2 bytes, CRC16 checksum of the Data Field.</p></li>
</ul>
<p>This framing format allows the receiver to detect message boundaries by searching for the sync marker, read the length of the incoming message, and verify data integrity using the checksum.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This framing format is intentionally simple. Others (such as COBS or SLIP) were considered, but for now they’re simply overkill, and this is very easy to implement on both ends.</p>
</div>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
<p>
  &#169; Copyright 2025, Cave in the Mountains.
</p>

  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>